### **Clean Architecture vs. Hexagonal Architecture (Brief Explanation)**

#### **1. Clean Architecture**

- **Principles:**

  - Business logic is at the core, independent of frameworks and external systems.
  - **Dependency Rule:** Outer layers depend on inner layers, but not vice versa.
  - Clear separation of concerns: **Entities â†’ Use Cases â†’ Interfaces â†’ Infrastructure**.

- **Example Directory Structure:**

  ```
  order-system/
  â”œâ”€â”€ domain/           # Business entities (Order, Customer)
  â”œâ”€â”€ application/      # Use cases (CreateOrderUseCase)
  â”œâ”€â”€ infrastructure/   # Database implementations (MySQLOrderRepository)
  â”œâ”€â”€ interfaces/       # External APIs (REST, GraphQL)
  â”œâ”€â”€ main.ts          # Application entry point
  ```

- **Advantages:**  
  âœ… Strong business logic isolation  
  âœ… Easier testing and maintainability  
  âœ… Flexible for framework and database changes

---

#### **2. Hexagonal Architecture (Ports & Adapters)**

- **Principles:**

  - Business logic is **fully isolated** from external systems.
  - Uses **Ports & Adapters** to communicate with the outside world (DB, APIs, services).
  - Components interact through well-defined interfaces (ports).

- **Example Directory Structure:**

  ```
  order-system/
  â”œâ”€â”€ core/           # Business logic (domain models, use cases)
  â”œâ”€â”€ ports/          # Interfaces (OrderRepository, PaymentService)
  â”œâ”€â”€ adapters/       # Implementations (MySQL, Stripe, REST API)
  â”œâ”€â”€ main.ts        # Application entry point
  ```

- **Advantages:**  
  âœ… Easily replace or extend technologies (DB, APIs, services)  
  âœ… High flexibility and scalability  
  âœ… Strong separation between business logic and external systems

---

#### **Key Differences:**

| Feature               | Clean Architecture                             | Hexagonal Architecture                          |
| --------------------- | ---------------------------------------------- | ----------------------------------------------- |
| **Structure**         | Layered (Domain â†’ Use Cases â†’ Infra)           | Ports & Adapters model                          |
| **Dependency Rule**   | Inner layers are independent                   | Business logic fully isolated via ports         |
| **Technology Change** | Requires infrastructure layer updates          | Easily replace adapters                         |
| **Best Use Case**     | Large applications with clear layer separation | API-driven, microservices, plugin-based systems |

ğŸ’¡ **Both can be combined!** Clean Architecture's **Use Cases** can be implemented with Hexagonal **Ports & Adapters** for a more flexible system. ğŸš€

### **Clean Architecture & Hexagonal Architecture ã®èª¬æ˜ | Explanation of Clean Architecture & Hexagonal Architecture**

---

## **1. ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ (Clean Architecture)**

### ğŸ— **åŸºæœ¬åŸå‰‡ | Basic Principles**

- **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¸­å¿ƒã«æ§‹ç¯‰**ã™ã‚‹ã€‚
- **ä¾å­˜æ–¹å‘ã¯å¤–ã‹ã‚‰å†…ã®ã¿**ã€‚ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¾å­˜ã—ãªã„ã€‚
- **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å±¤ã‚’åˆ†é›¢**ã™ã‚‹ã“ã¨ã§ã€å¤‰æ›´ã®å½±éŸ¿ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹ã€‚

### ğŸ“‚ **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€  | Directory Structure**

```
order-system/
â”‚â”€â”€ src/
â”‚   â”œâ”€â”€ domain/                 # ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ« (Entities)
â”‚   â”‚   â”œâ”€â”€ Order.ts
â”‚   â”‚   â”œâ”€â”€ Product.ts
â”‚   â”‚   â”œâ”€â”€ Customer.ts
â”‚   â”œâ”€â”€ application/             # ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ (Use Cases)
â”‚   â”‚   â”œâ”€â”€ CreateOrderUseCase.ts
â”‚   â”‚   â”œâ”€â”€ GetOrderDetailsUseCase.ts
â”‚   â”œâ”€â”€ infrastructure/          # ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ (Adapters)
â”‚   â”‚   â”œâ”€â”€ database/             # DB å®Ÿè£… (MySQL, MongoDB ãªã©)
â”‚   â”‚   â”‚   â”œâ”€â”€ MySQLOrderRepository.ts
â”‚   â”œâ”€â”€ interfaces/              # å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (REST, CLI, GraphQL)
â”‚   â”œâ”€â”€ main.ts                  # ã‚¢ãƒ—ãƒªã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
```

### âœ… **ãƒ¡ãƒªãƒƒãƒˆ | Advantages**

âœ” **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒç‹¬ç«‹**ã—ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å¤‰æ›´ãŒå®¹æ˜“ã€‚  
âœ” **ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„**ï¼ˆãƒ¢ãƒƒã‚¯ã‚’åˆ©ç”¨ã—ã‚„ã™ã„ï¼‰ã€‚  
âœ” **ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ãƒ»ä¿å®ˆæ€§ãŒå‘ä¸Š**ã€‚

---

## **2. ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ (Hexagonal Architecture | Ports & Adapters)**

### ğŸ— **åŸºæœ¬åŸå‰‡ | Basic Principles**

- **"Ports & Adapters"** ã®æ¦‚å¿µã‚’ä¸­å¿ƒã«è¨­è¨ˆã€‚
- **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯å®Œå…¨ã«ç‹¬ç«‹**ã—ã¦ãŠã‚Šã€å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®æ¥ç¶šã¯ã€Œãƒãƒ¼ãƒˆã€ã‚’é€šã˜ã¦è¡Œã†ã€‚
- **ç•°ãªã‚‹æŠ€è¡“ï¼ˆDB, API, æ”¯æ‰•ã„ã‚·ã‚¹ãƒ†ãƒ ãªã©ï¼‰ã®é©å¿œãŒå®¹æ˜“**ã€‚

### ğŸ“‚ **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€  | Directory Structure**

```
order-system/
â”‚â”€â”€ src/
â”‚   â”œâ”€â”€ core/                   # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ (Application Core)
â”‚   â”‚   â”œâ”€â”€ domain/              # ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”‚   â”œâ”€â”€ Order.ts
â”‚   â”‚   â”œâ”€â”€ ports/               # ãƒãƒ¼ãƒˆ (ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹)
â”‚   â”‚   â”‚   â”œâ”€â”€ OrderRepository.ts
â”‚   â”œâ”€â”€ adapters/                # ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ (Adapters)
â”‚   â”‚   â”œâ”€â”€ persistence/         # DB ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ (MySQL, MongoDB)
â”‚   â”‚   â”‚   â”œâ”€â”€ MySQLOrderRepository.ts
â”‚   â”‚   â”œâ”€â”€ api/                 # API ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ (REST, GraphQL)
â”‚   â”‚   â”œâ”€â”€ payment/             # æ”¯æ‰•ã„ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ (Stripe, PayPal)
â”‚   â”œâ”€â”€ main.ts                  # ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
```

### âœ… **ãƒ¡ãƒªãƒƒãƒˆ | Advantages**

âœ” **æŠ€è¡“å¤‰æ›´ãŒç°¡å˜**ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€APIã€æ”¯æ‰•ã„ã‚·ã‚¹ãƒ†ãƒ ã‚’ç°¡å˜ã«ç½®ãæ›ãˆå¯èƒ½ï¼‰ã€‚  
âœ” **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®ç‹¬ç«‹æ€§ãŒé«˜ã„**ã€‚  
âœ” **ãƒãƒ¼ãƒˆ & ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ä»•çµ„ã¿ã§æ‹¡å¼µã—ã‚„ã™ã„**ã€‚

---

## **3. å…·ä½“ä¾‹ | Concrete Example**

ä¾‹ãˆã°ã€EC ã‚µã‚¤ãƒˆã§ **æ³¨æ–‡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆOrder Management Systemï¼‰** ã‚’æ§‹ç¯‰ã™ã‚‹å ´åˆã‚’è€ƒãˆã¾ã™ã€‚  
Let's consider an **Order Management System for an E-Commerce site**.

### **ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä¾‹ | Clean Architecture Example**

```typescript
// src/application/use-cases/CreateOrderUseCase.ts
import { Order } from "../../domain/models/Order";
import { OrderRepository } from "../../domain/repositories/OrderRepository";

export class CreateOrderUseCase {
  constructor(private orderRepo: OrderRepository) {}

  async execute(customerId: string, products: string[]) {
    const order = new Order(customerId, products);
    return await this.orderRepo.save(order);
  }
}
```

- **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ (`CreateOrderUseCase`) ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¾å­˜ã—ãªã„**
- `OrderRepository` ã¯ **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹** ã¨ã—ã¦å®šç¾©ã•ã‚Œã€å…·ä½“çš„ãªå®Ÿè£…ï¼ˆMySQL, MongoDBï¼‰ã¯ `infrastructure` ã«ã‚ã‚‹

---

### **ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä¾‹ | Hexagonal Architecture Example**

```typescript
// src/core/ports/PaymentService.ts
export interface PaymentService {
  charge(amount: number): Promise<boolean>;
}

// src/adapters/payment/StripePaymentAdapter.ts
import { PaymentService } from "../../core/ports/PaymentService";

export class StripePaymentAdapter implements PaymentService {
  async charge(amount: number): Promise<boolean> {
    console.log(`Charging $${amount} via Stripe`);
    return true;
  }
}
```

- **`PaymentService` ã¯ãƒãƒ¼ãƒˆï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰** ã§ã‚ã‚Šã€**æ”¯æ‰•ã„ã‚·ã‚¹ãƒ†ãƒ ï¼ˆStripe, PayPalï¼‰ã‚’è‡ªç”±ã«å·®ã—æ›¿ãˆå¯èƒ½**
- **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯ã©ã®æ”¯æ‰•ã„æ–¹æ³•ã‚’ä½¿ã†ã‹ã‚’æ„è­˜ã—ãªã„**

---

## **4. ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ vs ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ | Comparison**

| ğŸ“Œ æ¯”è¼ƒé …ç›®        | ğŸ— ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£                                 | ğŸ”· ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£               |
| ------------------ | -------------------------------------------------------- | ------------------------------------------- |
| **çµ„ç¹”æ§‹é€ **       | å±¤æ§‹é€  (Domain, Application, Infrastructure, Interfaces) | ãƒãƒ¼ãƒˆ & ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ (Ports & Adapters)      |
| **ä¾å­˜é–¢ä¿‚**       | ä¾å­˜ã¯ã€Œå¤–ã‹ã‚‰å†…ã®ã¿ã€                                   | ã‚³ã‚¢ã¯ãƒãƒ¼ãƒˆçµŒç”±ã§å¤–éƒ¨ã¨æ¥ç¶š                |
| **ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹** | `repositories/` ã§å®šç¾©                                   | `ports/OrderRepository.ts` ã§å®šç¾©           |
| **æ‹¡å¼µæ€§**         | å¤‰æ›´ã«å¼·ã„ãŒæŠ€è¡“å¤‰æ›´ã¯æ‰‹é–“                               | æ–°ã—ã„æŠ€è¡“ã‚’ç°¡å˜ã«è¿½åŠ å¯èƒ½                  |
| **é©ç”¨å ´é¢**       | å¤§è¦æ¨¡ã‚·ã‚¹ãƒ†ãƒ ã€å±¤ã‚’æ˜ç¢ºåŒ–                               | API, ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å‹ã‚·ã‚¹ãƒ†ãƒ  |

---

## **5. ã©ã¡ã‚‰ã‚’é¸ã¶ã¹ãã‹ï¼Ÿ | Which Should You Choose?**

âœ… **ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£** ã¯ã€**å¤§è¦æ¨¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„æ˜ç¢ºãªå±¤åˆ†ã‘ãŒå¿…è¦ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ** ã«å‘ã„ã¦ã„ã¾ã™ã€‚  
âœ… **ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£** ã¯ã€**æŠ€è¡“ã®å¤‰æ›´ã‚„å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆãŒå¤šã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³** ã«é©ã—ã¦ã„ã¾ã™ã€‚

ğŸ’¡ **çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã‚‚å¯èƒ½ï¼**  
å®Ÿéš›ã«ã¯ã€**ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã® Use Cases å±¤ã‚’ ãƒ˜ã‚­ã‚µã‚´ãƒŠãƒ«ã® Ports & Adapters ã§è¨­è¨ˆ** ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚ŠæŸ”è»Ÿãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚

---

âœ¨ **ã‚ãªãŸã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ã©ã¡ã‚‰ãŒé©ã—ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ** ğŸš€
